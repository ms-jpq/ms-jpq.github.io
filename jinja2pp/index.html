<!DOCTYPE html><html >
  <head >
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title >
      Creative Portfolio
    </title>
    <link href="/pages_repo.css" rel="stylesheet"/>
 
    <script defer src="/layout.js"></script>
  </head>
  <body class="d-grid vw-100 mp-0">
    <header class="d-grid grid-col px-4">
      <button class="big-button text-justify">
  <i class="fas fa-bars"></i>
Menu

</button>

      <h2 class="text-uppercase text-ellipsis mb-0" id="header-title">
  <a class="invis-link" href="/index.html">
    Creative Portfolio
  </a>
</h2>

    </header>
    <aside class="ac-start px-4" id="left-panel">
      <section class="d-grid ji-centre" id="headshot">
  <img class="border-circle px-3 py-3" height="1428" loading="lazy" src="/e107ea3b2f28b156c79a435e1b92e7ceab6c66669ce34fd5b2bd33172e91a23d.webp" srcset="/e107ea3b2f28b156c79a435e1b92e7ceab6c66669ce34fd5b2bd33172e91a23d--1000x988.webp 1000w, /e107ea3b2f28b156c79a435e1b92e7ceab6c66669ce34fd5b2bd33172e91a23d--200x198.webp 200w, /e107ea3b2f28b156c79a435e1b92e7ceab6c66669ce34fd5b2bd33172e91a23d--400x395.webp 400w, /e107ea3b2f28b156c79a435e1b92e7ceab6c66669ce34fd5b2bd33172e91a23d--600x593.webp 600w, /e107ea3b2f28b156c79a435e1b92e7ceab6c66669ce34fd5b2bd33172e91a23d--800x790.webp 800w" width="1446"/>
</section>

      <section id="about-me">
  <div class="markdown mx-1">
    <p >I dunno? I guess im pretty good at programming, and … tetris.</p>
<p >I also really like dogs.</p>
<p >🐶🐕🦮🐩🐕‍🦺🐾 are really good frens.</p>
  </div>
</section>

      <section id="nav">
  <nav >
    <ul >
      <li class="text-capitalize ">
        <a href="/index.html">home</a>
      </li>
      <li class="text-capitalize ">
        <a href="/about_me.html">about</a>
      </li>
      <li class="text-capitalize ">
        <a href="/contact_me.html">get in touch</a>
      </li>
    </ul>
  </nav>
</section>

      <section class="associations d-flex flex-wrap" id="associations">
  <a class="association-circle border-solid border-thin border-circle d-flex ai-centre jc-centre p-2 m-2 text-centre" href="mailto:github@bigly.dog">
  <i class="far fa-envelope"></i>
</a>

  <a class="association-circle border-solid border-thin border-circle d-flex ai-centre jc-centre p-2 m-2 text-centre" href="https://github.com/ms-jpq">
  <i class="fab fa-github"></i>
</a>

  <a class="association-circle border-solid border-thin border-circle d-flex ai-centre jc-centre p-2 m-2 text-centre" href="https://stackexchange.com/users/15744711">
  <i class="fab fa-stack-overflow"></i>
</a>

</section>

    </aside>
    <main class="d-grid row-gap-8">
  <section class="d-grid grid-col jc-end ai-centre mx-auto col-gap-4" id="repo-header">
    <span class="github-stars ">
  <i class="fas fa-star"></i>
  2
</span>

    <span class="github-forks ">
  <i class="fas fa-code-branch"></i>
  1
</span>

    <a class="invis-link" href="https://github.com/ms-jpq/jinja2pp">
<button class="big-button text-justify">
        View on Github <i class="fab fa-github"></i>

</button>
    </a>
  </section>
  <section class="d-grid mx-auto" id="repo-body">
    <div class="markdown">
      <h1 id="jinja2"><a href="https://ms-jpq.github.io/jinja2pp/">Jinja2++</a></h1>
<p >Jinja2++ is a drop in single file solution for templating with <strong >Variable Precedence</strong>.</p>
<p >You can use <strong >ANY language!</strong></p>
<h2 id="how-it-works">How it works</h2>
<p >Based on the Unix pipeline : <code >JSON - stdin |&gt; stdout - JSON</code></p>
<p >A var_file is any executable that slurps JSON from STDIN, and spits JSON from STD out.</p>
<p >We assemble a series of cascading var_files based on the file hierarchy to overwrite proceeding variables.</p>
<p >We also do context injection, in the same fashion, ie context as the local path of each var_file / template, etc</p>
<h2 id="features">Features</h2>
<h3 id="variable-precedence">Variable precedence</h3>
<div class="codehilite friendly"><pre ><span ></span><code ><span class="n">src</span>
<span class="o">|</span><span class="err">──</span> <span class="n">vars</span><span class="p">.</span><span class="n">perl</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="p">[[</span><span class="n">base</span> <span class="n">variables</span><span class="p">]]</span>
<span class="err">├──</span> <span class="n">filters</span><span class="p">.</span><span class="n">py</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="n">inject</span> <span class="p">((</span><span class="n">J2</span> <span class="n">filters</span><span class="p">))</span> <span class="n">with</span> <span class="o">~</span><span class="n">vanilla</span> <span class="n">python</span><span class="o">~</span> <span class="n">functions</span><span class="o">!</span>
<span class="p">...</span>
<span class="err">├──</span> <span class="n">render_inject</span><span class="p">.</span><span class="n">rb</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="n">inject</span> <span class="o">&amp;&amp;</span> <span class="n">overwrite</span> <span class="p">[</span><span class="n">pre</span><span class="o">-</span><span class="n">render</span> <span class="n">context</span><span class="p">]</span> <span class="n">variables</span>
<span class="err">├──</span> <span class="n">var_inject</span><span class="p">.</span><span class="n">sh</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="n">inject</span> <span class="o">&amp;&amp;</span> <span class="n">overwrite</span> <span class="p">[</span><span class="n">pre</span><span class="o">-</span><span class="n">script</span> <span class="n">context</span><span class="p">]</span> <span class="n">variables</span>
<span class="p">...</span>
<span class="err">├──</span> <span class="n">monitoring</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">├──</span> <span class="n">grafana</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">├──</span> <span class="n">templates</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">├──</span> <span class="n">Chart</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">j2</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">└──</span> <span class="n">vars</span><span class="p">.</span><span class="n">js</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="n">overwrite</span><span class="p">]</span> <span class="n">variables</span> <span class="n">here</span>
<span class="err">│</span>  <span class="err">├──</span> <span class="n">iperf</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">├──</span> <span class="n">templates</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">├──</span> <span class="n">Chart</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">j2</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">└──</span> <span class="n">vars</span><span class="p">.</span><span class="n">fsi</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="n">overwrite</span><span class="p">]</span> <span class="n">variables</span> <span class="n">here</span>
<span class="err">│</span>  <span class="err">├──</span> <span class="n">prometheus</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">├──</span> <span class="n">templates</span><span class="o">/</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">├──</span> <span class="n">Chart</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">j2</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="err">└──</span> <span class="n">vars</span><span class="p">.</span><span class="n">exe</span><span class="o">*</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="n">overwrite</span><span class="p">]</span> <span class="n">variables</span> <span class="n">here</span>
<span class="p">...</span>
</code></pre></div>

<h3 id="dry-runs">Dry runs</h3>
<p ><img alt="dryrun.png" height="580" loading="lazy" src="/462b7478494226cacb001476a068c13cc724b85d9e814299ac0bdcbada4cc7bf.webp" srcset="/462b7478494226cacb001476a068c13cc724b85d9e814299ac0bdcbada4cc7bf--1000x267.webp 1000w, /462b7478494226cacb001476a068c13cc724b85d9e814299ac0bdcbada4cc7bf--200x53.webp 200w, /462b7478494226cacb001476a068c13cc724b85d9e814299ac0bdcbada4cc7bf--400x107.webp 400w, /462b7478494226cacb001476a068c13cc724b85d9e814299ac0bdcbada4cc7bf--600x160.webp 600w, /462b7478494226cacb001476a068c13cc724b85d9e814299ac0bdcbada4cc7bf--800x214.webp 800w" width="2172"/></p>
<p ><img alt="res.png" height="458" loading="lazy" src="/365dd2362afe6dd140c9bb241ba0315843dce77a4e236e911552ca65655a3ed0.webp" srcset="/365dd2362afe6dd140c9bb241ba0315843dce77a4e236e911552ca65655a3ed0--1000x212.webp 1000w, /365dd2362afe6dd140c9bb241ba0315843dce77a4e236e911552ca65655a3ed0--200x42.webp 200w, /365dd2362afe6dd140c9bb241ba0315843dce77a4e236e911552ca65655a3ed0--400x85.webp 400w, /365dd2362afe6dd140c9bb241ba0315843dce77a4e236e911552ca65655a3ed0--600x127.webp 600w, /365dd2362afe6dd140c9bb241ba0315843dce77a4e236e911552ca65655a3ed0--800x169.webp 800w" width="2162"/></p>
<h3 id="syntax-highlighted-diff">Syntax highlighted diff</h3>
<p ><img alt="diff1.png" height="252" loading="lazy" src="/a700f4dc4a8c8467c4c6f5740b8b4a504b48dc20d34b3a6e8e8a7cfb6f647c78.webp" srcset="/a700f4dc4a8c8467c4c6f5740b8b4a504b48dc20d34b3a6e8e8a7cfb6f647c78--1000x115.webp 1000w, /a700f4dc4a8c8467c4c6f5740b8b4a504b48dc20d34b3a6e8e8a7cfb6f647c78--200x23.webp 200w, /a700f4dc4a8c8467c4c6f5740b8b4a504b48dc20d34b3a6e8e8a7cfb6f647c78--400x46.webp 400w, /a700f4dc4a8c8467c4c6f5740b8b4a504b48dc20d34b3a6e8e8a7cfb6f647c78--600x69.webp 600w, /a700f4dc4a8c8467c4c6f5740b8b4a504b48dc20d34b3a6e8e8a7cfb6f647c78--800x92.webp 800w" width="2182"/></p>
<p ><img alt="diff2.png" height="364" loading="lazy" src="/80cc35bab7bbc9d004ef310d048657120a9acde8692f4f05a76d20fe26cd02e1.webp" srcset="/80cc35bab7bbc9d004ef310d048657120a9acde8692f4f05a76d20fe26cd02e1--1000x167.webp 1000w, /80cc35bab7bbc9d004ef310d048657120a9acde8692f4f05a76d20fe26cd02e1--200x33.webp 200w, /80cc35bab7bbc9d004ef310d048657120a9acde8692f4f05a76d20fe26cd02e1--400x67.webp 400w, /80cc35bab7bbc9d004ef310d048657120a9acde8692f4f05a76d20fe26cd02e1--600x100.webp 600w, /80cc35bab7bbc9d004ef310d048657120a9acde8692f4f05a76d20fe26cd02e1--800x134.webp 800w" width="2176"/></p>
<h3 id="dynamic-j2-filter-import">Dynamic J2 filter import</h3>
<p >Write your filters as vanilla Python functions.</p>
<p >like so:</p>
<div class="codehilite friendly"><pre ><span ></span><code ><span class="k">def</span> <span class="nf">drop_first</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>


<span class="k">def</span> <span class="nf">base64</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">encoded</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">b64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">encoded</span> <span class="k">if</span> <span class="n">encoded</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="context-injection">Context injection</h3>
<p >The following <code >[context variables]</code> will be injected before each var_file / template.</p>
<p >add more of your own!</p>
<div class="codehilite friendly"><pre ><span ></span><code ><span class="p">{</span><span class="nt">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
 <span class="nt">&quot;_dest_&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
 <span class="nt">&quot;_dir_&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
 <span class="nt">&quot;_parent_&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
 <span class="nt">&quot;_grand_parent_&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
 <span class="nt">&quot;_var_file_/_template_&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">}</span>
</code></pre></div>

<h2 id="usage">Usage</h2>
<p >Simply call <code >./j2pp.py</code> with the following:</p>
<p ><strong >Note: For large projects you may need to call <code >ulimit -S -n &lt;number&gt;</code> to increase # of concurrent open files by a unix process.</strong></p>
<p >This is required prior to calling <code >./j2pp.py</code> due to the fact that it does parallel processing.</p>
<h3 id="arguments">Arguments</h3>
<p ><code >--src</code></p>
<p >Put all your .j2 templates here, along with var_files.</p>
<p ><code >--out</code></p>
<p >Your finished templates go here.</p>
<p ><code >--exclude</code></p>
<p >Any file paths in exclude will be skipped. i.e. –exclude .s .skip</p>
<p ><code >--var-files</code></p>
<p >A VAR_FILE is an executable: .py, .sh, et al.<br />
VAR_FILES are how you do variable injections.<br />
JSON - stdin |&gt; stdout - JSON.<br />
VAR_FILES are placed in the file hierarchy<br />
beween *.j2 and SRC.<br />
VAR_FILES closes to *.j2 have higher precedence.</p>
<p ><code >--import-filters</code></p>
<p >All functions in IMPORT_FILTERS will be included as<br />
j2 filters. Must be python files.</p>
<p ><code >--inject-before-vars</code></p>
<p >Same semantics as VAR_FILES,<br />
except run before each VAR_FILE.</p>
<p ><code >--inject-before-render</code></p>
<p >Same semantics as VAR_FILES,<br />
except run before each .j2 file is rendered.</p>
<p ><code >--extra-vars</code></p>
<p >Inject variables with JSON.<br />
Highest precedence, also available to all var files.</p>
<p ><code >--delimiter</code></p>
<p >Default is 🦄.<br />
Any stdout in VAR_FILES before the last occurance<br />
of 🦄 will be treated as comments.<br />
🦄 is entirely optional.</p>
<p ><code >--dry-run</code></p>
<p >Just do a diff, dont write to file.</p>
<p ><code >--no-diffs</code></p>
<p >Dont print diff.</p>
<p ><code >--formatter</code></p>
<p >Used to print diff, if your terminal is kinda wonky,<br />
pick one with less colours.</p>
    </div>
  </section>
  <section class="d-grid ji-end mx-auto col-gap-4" id="repo-footer">
    <div >
      <i class="fas fa-user-edit text-start"></i>
      <time datetime="2021-07-07T00:28:22+0000"></time>
    </div>
    <div >
      <i class="fas fa-baby text-start"></i>
      <time datetime="2019-12-18T02:55:07+0000"></time>
    </div>
  </section>
</main>

    <footer class="d-grid ji-centre ai-centre">
      <div class="markdown">
  <p >© 2021 <a href="https://github.com/ms-jpq">ms-jpq</a></p>
</div>

    </footer>
  </body>
</html>